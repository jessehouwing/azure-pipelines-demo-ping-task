"use strict";
var mockery = require('mockery');
var TaskMockRunner = (function () {
    function TaskMockRunner(taskPath) {
        this._taskPath = taskPath;
    }
    TaskMockRunner.prototype.setInput = function (name, val) {
        process.env['INPUT_' + name.replace(' ', '_').toUpperCase()] = val;
    };
    TaskMockRunner.prototype.setAnswers = function (answers) {
        this._answers = answers;
    };
    TaskMockRunner.prototype.registerMock = function (modName, mod) {
        mockery.registerMock(modName, mod);
    };
    TaskMockRunner.prototype.run = function () {
        mockery.enable({ warnOnUnregistered: false });
        var tlm = require('vsts-task-lib/mock-task');
        if (this._answers) {
            tlm.setAnswers(this._answers);
        }
        mockery.registerMock('vsts-task-lib/task', tlm);
        // run it
        require(this._taskPath);
    };
    return TaskMockRunner;
}());
exports.TaskMockRunner = TaskMockRunner;
